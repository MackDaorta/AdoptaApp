{% extends 'layout.html' %}

{% block content %}
<div class="container mt-4">

    <!-- =========================================================
         SECCIÓN: TÍTULO Y DATOS PRINCIPALES DE LA MASCOTA
         ---------------------------------------------------------
         TODO: Mostrar aquí el nombre de la mascota usando
               la variable de contexto 'mascota'.
         ========================================================= -->
    <h2>Galería de {{ mascota.nombre }}</h2>

    <hr>

    <!-- =========================================================
         SECCIÓN: LISTA / GALERÍA DE POSTS DE LA MASCOTA
         ---------------------------------------------------------
         CONTEXTO:
         - La vista envía una variable 'posts' con la lista de
           publicaciones (PostMascota) asociadas a esta mascota.

         OBJETIVO:
         - Recorrer 'posts' con un bucle for y mostrar cada post
           en una tarjeta (card) o bloque simple.
         
         Dentro del for, mostrar:
              - Título del post
              - Fecha del post
              - Descripción del post
              - Imagen del post (campo foto)

         REVISAR VISTA DE DETALLE DE MASCOTA COMO REFERENCIA
         ========================================================= -->

    <div class="row">
     {% for post in posts %}
          <div class="col-md-4 mb-4">
               <div class="card h-100">
                    {% if post.foto %}
                         <img src="{{ post.foto.url }}" class="card-img-top" alt="{{ post.titulo }}" style="height: 200px; object-fit: cover;">
                    {% endif %}
                    <div class="card-body">
                         <h5 class="card-title">{{ post.titulo }}</h5>
                         <p class="text-muted"><small>{{ post.fecha }}</small></p>
                         <p class="card-text">{{ post.descripcion }}</p>
                    </div>

               </div>
          </div>
     {% empty %}
          <div class="col-12">
               <p class="alert alert-info">Aun no tiene momentos registrados</p>
          </div>
     {% endfor %}

    </div>


    <!-- =========================================================
         SECCIÓN: FORMULARIO PARA CREAR NUEVOS POSTS
         ---------------------------------------------------------
         CONTEXTO:
         - La vista, en la siguiente pregunta del examen, enviará
           un formulario 'form' basado en PostMascotaForm.

         OBJETIVO:
         - Mostrar el formulario dentro de la plantilla usando
           sintaxis de Django.
         ========================================================= -->

    <hr class="mt-4 mb-3">

    <h3>Registrar nuevo momento / publicación</h3>
<form method="POST" enctype="multipart/form-data" class="card p-4 shadow-sm">
     
     {% csrf_token %}

     {% if form.non_field_errors %}
          <div class="alert alert-danger">
               {{ form.non_field_errors }}
          </div>
     {% endif %}

     {% for field in form %}
          <div class="mb-3">
               <label class="form-label">{{ field.label }}</label>
               {{ field }}
               {% if field.errors %}
                    <div class="text-danger small">
                         {{ field.errors }}
                    </div>
               {% endif %}
          </div>
     {% endfor %}

     <button type="submit" class="btn btn-primary mt-2">Guardar publicación</button>


</form>
<hr class="mt-4 mb-3">
    <a href="{% url 'app1:home' %}" class="btn btn-secondary">Volver a inicio</a>


</div>
{% endblock %}
